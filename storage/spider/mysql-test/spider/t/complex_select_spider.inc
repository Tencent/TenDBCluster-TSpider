--connection master_1
SHOW CREATE TABLE t1;

--eval SET spider_quick_mode = $quick_mode
--eval SET spider_semi_split_read = $semi_split_read
--eval SET spider_direct_order_limit = $direct_order_limit

INSERT INTO t1 VALUES(1,5,5),(3,5,4),(5,7,3),(7,3,2),(9,5,6),(11,0,8),(13,7,4),(15,3,2),(21,5,6),(17,7,6),(19,1,5);
INSERT INTO t1 VALUES(8,4,4),(12,4,4),(10,9,6),(4,11,18),(2,17,5),(6,9,6),(18,7,4),(20,7,4),(14,4,4),(22,9,5),(0,5,5),(16,15,12);

--connection child2_1
SELECT * FROM t1;

--connection child2_2
SELECT * FROM t1;

--connection master_1

# DISTINCT / LIMIT / WHERE / GROUP BY / ORDER BY / AGGRs

# WITH DISTINCT
# 0. DISTINCT
SELECT DISTINCT c1 FROM t1;
SELECT DISTINCT c2 FROM t1;
SELECT DISTINCT c3 FROM t1;

# 1. DISTINCT + WHERE
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5;
SELECT DISTINCT c2 FROM t1 WHERE c1 > 5;
SELECT DISTINCT c3 FROM t1 WHERE c1 > 5;
SELECT DISTINCT c1 FROM t1 WHERE c2 > 4;
SELECT DISTINCT c2 FROM t1 WHERE c2 > 4;
SELECT DISTINCT c3 FROM t1 WHERE c2 > 4;
SELECT DISTINCT c1 FROM t1 WHERE c3 > 6;
SELECT DISTINCT c2 FROM t1 WHERE c3 > 6;
SELECT DISTINCT c3 FROM t1 WHERE c3 > 6;

# 2. DISTINCT + LIMIT 
SELECT DISTINCT c1 FROM t1 LIMIT 3;
SELECT DISTINCT c2 FROM t1 LIMIT 3;
SELECT DISTINCT c3 FROM t1 LIMIT 3;

# 3. DISTINCT + GROUP BY
SELECT DISTINCT c1 FROM t1 GROUP BY c1;
SELECT DISTINCT c2 FROM t1 GROUP BY c2;
SELECT DISTINCT c3 FROM t1 GROUP BY c3;

# 4. DISTINCT + ORDER BY
SELECT DISTINCT c1 FROM t1 ORDER BY c1;
SELECT DISTINCT c2 FROM t1 ORDER BY c2;
SELECT DISTINCT c3 FROM t1 ORDER BY c3;
SELECT DISTINCT c1,c2 FROM t1 ORDER BY c1;
SELECT DISTINCT c2,c3 FROM t1 ORDER BY c2;
SELECT DISTINCT c3,c1 FROM t1 ORDER BY c3;
SELECT DISTINCT c1,c2 FROM t1 ORDER BY c2;
SELECT DISTINCT c2,c3 FROM t1 ORDER BY c3;
SELECT DISTINCT c3,c1 FROM t1 ORDER BY c1;
SELECT DISTINCT c1,c2 FROM t1 ORDER BY c3;
SELECT DISTINCT c2,c3 FROM t1 ORDER BY c2;
SELECT DISTINCT c3,c1 FROM t1 ORDER BY c1;

# 5. DISTINCT + WHERE + LIMIT
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 LIMIT 5;
SELECT DISTINCT c2 FROM t1 WHERE c2 > 4 LIMIT 5;
SELECT DISTINCT c3 FROM t1 WHERE c2 > 6 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 LIMIT 5;

# 6. DISTINCT + WHERE + GROUP BY
# 7. DISTINCT + WHERE + GROUP BY + LIMIT
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 GROUP BY c1;
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 GROUP BY c1 LIMIT 5;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 GROUP BY c2;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 GROUP BY c2 LIMIT 5;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 GROUP BY c3;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 GROUP BY c3 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c2;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c2 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c3;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c3 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c1;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c1 LIMIT 5;

# 8. DISTINCT + WHERE + ORDER BY
# 9. DISTINCT + WHERE + ORDER BY + LIMIT
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 ORDER BY c1 LIMIT 5;

# 10. DISTINCT + WHERE + GROUP BY + ORDER BY
# 11. DISTINCT + WHERE + GROUP BY + ORDER BY + LIMIT
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 GROUP BY c1 ORDER BY c1;
SELECT DISTINCT c1 FROM t1 WHERE c1 > 5 GROUP BY c1 ORDER BY c1 LIMIT 5;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 GROUP BY c2 ORDER BY c2;
SELECT DISTINCT c2 FROM t1 WHERE c2 < 10 GROUP BY c2 ORDER BY c2 LIMIT 5;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 GROUP BY c3 ORDER BY c3;
SELECT DISTINCT c3 FROM t1 WHERE c3 < 10 GROUP BY c3 ORDER BY c3 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1 ORDER BY c1, c2;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1 ORDER BY c1, c2 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2 ORDER BY c2, c3;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2 ORDER BY c2, c3 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3 ORDER BY c3, c1;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3 ORDER BY c3, c1 LIMIT 5;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1 ORDER BY c2, c1;
SELECT DISTINCT c1, c2 FROM t1 WHERE c1 > 5 AND c2 > 4 GROUP BY c1 ORDER BY c2, c1 LIMIT 5;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2 ORDER BY c3, c2;
SELECT DISTINCT c2, c3 FROM t1 WHERE c2 > 4 AND c3 > 7 GROUP BY c2 ORDER BY c3, c2 LIMIT 5;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3 ORDER BY c1, c3;
SELECT DISTINCT c1, c3 FROM t1 WHERE c1 > 6 AND c3 < 8 GROUP BY c3 ORDER BY c1, c3 LIMIT 5;

TRUNCATE TABLE t1;

